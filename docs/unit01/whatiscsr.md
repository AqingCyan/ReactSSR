# CSR与SSR从渲染聊起

要理解服务端渲染，我们需要理解现在的开发模式下，浏览器呈现网页的内容是从哪里得到的？

## 首先了解一下CSR

CSR即为 client side render，在客户端一方来进行页面的渲染。

页面的内容不完全在最开始请求的时候就存在在页面的 HTML 结构中。

页面的很多内容，都是通过接口请求数据，靠前端通过JS动态处理来生成页面需要的结构以及页面展示。

### 理解CSR的方式

我们说，CSR模式下，渲染依靠 JavaScript 来调用接口加载数据，并且处理生成页面。这里 JS 有两件事：

- 调用接口加载数据
- 处理生成页面内容

那么就可以理解，通过客户端渲染，离开了 JS ，页面就无法渲染出预期的样子，因此，我们可以做个实验。

```shell script
npx create-react-app test
```

使用 React 官方提供的脚手架创建一个基础的 React app，然后并且运行，访问页面，我们可以看到一个基础的 React 页面。

此时，我们右键查看网页的源代码，可以看到，页面上大部分的内容，是不存在在网页的源代码之中的，这是第一点。第二点，如果我们此时在浏览器的设置中，禁止运行 JS 代码，
再次刷新页面，会看到页面有如下内容：

```html
You need to enable JavaScript to run this app
```

### 解释原因

造成上面情况的原因其实也不难理解，我们在查看网页源代码的时候虽然看不到页面的内容出现在源码中，但是能看到底部的 `<script></script>` 加载了一个 bundle.js 文件。它在 React app 运行的时候，做了渲染这件事。
也就是请求数据（上面的例子没有），还有运行生成页面的内容。所以，在我们禁用的时候，这个 app 就开始告诉你需要你允许 JavaScript 才行。

### CSR这样做的后果

因为页面渲染的是放在了前端，前端可专注于页面效果、美观。严谨的做到了前后端分离的开发模式。后端专注于数据逻辑。分工更明晰，开发效率更高。

得益于框架，MVVM模式的流行，现在的页面用户体验也得到了很大的提升。我们将页面做成 SPA，一次性加载好了整个网站，它就像一个基于浏览器的已经下载好的 app，尤其是在移动端，体验近乎于原生。

但这么做，客户端加载页面需要较长时间，客户端渲染还要进行拼接字符串的过程，还需要耗费较多的性能。

我们查看过源代码，也知道，页面的内容是没有写在源代码当中的，那么这种情况下，也不利于搜索引擎的优化。因为服务器端没有保存完整的html，那么爬虫无法爬取信息。 除非搜索引擎的seo可以增加对于JavaScript的爬取与解析能力，这才能保证seo。

在网络较差的环境下，我们可能会看到页面是空白的不完整的（JS此时还没处理好数据与页面结构），然后数据突然闪现到页面上造成页面的抖动。

> 那么上述缺点如何改进？这里就开始引入一个老酒装新瓶的概念：服务端渲染
